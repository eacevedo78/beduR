library(dplyr)
library(ggplot2)
df <- read.csv("https://raw.githubusercontent.com/beduExpert/Programacion-R-Santander-2022/main/Sesion-06/data/nyc_restaurants.csv", header = TRUE)
str(df)
df$East <- factor(df$East, labels = c("No", "Yes"))
df.select <- select(df, Price, Food, Decor, Service)
round(cor(df.select),4)
?pairs
pairs(~ Price + Food + Decor + Service + East,
data = df, gap = 0.4, cex.labels = 1.5)
attach(df)
#lm es linear model
m1 <- lm(Price ~ Food +Decor + Service  + East)
summary(m1)
m2 <- update(m1, ~.-Service)
summary(m2)
StanRes2 <- rstandard(m2)
par(mfrow = c(2, 2))
plot(Food, StanRes2, ylab = "Residuales Estandarizados")
plot(Decor, StanRes2, ylab = "Residuales Estandarizados")
plot(East, StanRes2, ylab = "Residuales Estandarizados")
qqnorm(StanRes2)
qqline(StanRes2)
dev.off()
shapiro.test(StanRes2)
par(mfrow = c(2, 2))
plot(Food, StanRes2, ylab = "Residuales Estandarizados")
plot(Decor, StanRes2, ylab = "Residuales Estandarizados")
plot(East, StanRes2, ylab = "Residuales Estandarizados")
qqnorm(StanRes2)
qqline(StanRes2)
shapiro.test(StanRes2)
data <- data.frame(
Food = c(18.6, 30.3, 22.1, 24.9),
Decor = c(20, 15, 10, 9),
East = c("Yes", "No", "Yes", "No")
)
predict(m2, newdata = data, interval = "confidence", level = 0.95)
df <- read.csv("https://raw.githubusercontent.com/beduExpert/Programacion-R-Santander-2022/main/Sesion-06/data/SwedishMotorInsurance.csv", header = TRUE)
head(df)
df.select <- select(df,Payment,Claims,Insured)
head(df.select)
m1 <- lm(Payment ~ Claims + Insured)
m1 <- rstandard(df.select)
#matriz de correlacion
round(cor(df.select),4)
attach(df.select)
